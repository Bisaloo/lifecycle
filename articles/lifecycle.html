<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage of the lifecycle package • lifecycle</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage of the lifecycle package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lifecycle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/lifecycle.html">Get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/r-lib/lifecycle">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Usage of the lifecycle package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/lifecycle/blob/master/vignettes/lifecycle.Rmd"><code>vignettes/lifecycle.Rmd</code></a></small>
      <div class="hidden name"><code>lifecycle.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lifecycle)</a></code></pre></div>
<p>Use lifecycle to document the status of your exported functions and arguments:</p>
<ul>
<li><p>Choose one of the 7 lifecycle stages a function or argument can be in. You can choose from 4 development stages (experimental, maturing, stable, and questioning) and 3 deprecation stages (soft-deprecated, deprecated, and defunct).</p></li>
<li><p>If the function or argument is deprecated, make sure your users know about by calling <code><a href="../reference/deprecate_soft.html">deprecate_soft()</a></code>, <code><a href="../reference/deprecate_soft.html">deprecate_warn()</a></code>, or <code><a href="../reference/deprecate_soft.html">deprecate_stop()</a></code>. These functions try to be informative without being too verbose, with increasing levels of verbosity as the deprecation stage advances.</p></li>
<li><p>Include the relevant lifecycle badge in your documentation.</p></li>
</ul>
<div id="stages" class="section level3">
<h3 class="hasAnchor">
<a href="#stages" class="anchor"></a>Stages</h3>
<p>The lifecycle stages for functions and arguments are summarised in the figure below. They’re designed to closely mirror the lifecycle stages for <a href="https://www.tidyverse.org/lifecycle/">packages</a>.</p>
<p><img src="figures/lifecycle.svg" width="75%"></p>
<p>There are two development stages.</p>
<ul>
<li><p><img src="figures/lifecycle-experimental.svg" alt="Experimental" style="vertical-align:middle"> This is a new feature that is in the very early stage of development. It is exported so users can start to use it and report feedback, but its interface and/or behaviour is likely to change in the future. It is generally best to avoid depending on experimental features.</p></li>
<li><p><img src="figures/lifecycle-maturing.svg" alt="Maturing" style="vertical-align:middle"> The interface and behaviour of a maturing feature has been roughed out, but finer details are likely to change. It still needs more feedback to find the optimal API.</p></li>
</ul>
<p>The probable end state of most functions is <em>stable</em>:</p>
<ul>
<li>
<img src="figures/lifecycle-stable.svg" alt="Stable" style="vertical-align:middle"> A feature is considered stable when the author is happy with its interface and behaviour. Major changes are unlikely, and breaking changes will occur gradually, through a deprecation process.</li>
</ul>
<p>Sometimes we are no longer certain that a feature follows or implements the right approach. In this case, we mark it as <em>questioning</em>. It can then either become <em>superseded</em> once we have implemented an alternative, or <em>deprecated</em>. The difference between superseded and deprecated is that a superseded feature is maintained indefinitely for backward compatibility. Alternatively, we may realise that a questioning feature is actually important, and move it back to stable. User feedback is usually important for taking these decisions and always welcome.</p>
<ol style="list-style-type: decimal">
<li><p><img src="figures/lifecycle-questioning.svg" alt="Questioning" style="vertical-align:middle"> The author is no longer convinced that the feature is the optimal approach. However, there are no recommended alternatives yet.</p></li>
<li><p><img src="figures/lifecycle-superseded.svg" alt="Superseded" style="vertical-align:middle"> (Previously called retired) A superseded feature is no longer under active development, and a known better alternative is available. However, it is indefinitely kept in the package for backward compatibility. The author will only make the necessary changes to ensure that the function continues working. No new features will be added, and only critical bugs will be fixed.</p></li>
</ol>
<p>The deprecation lifecycle is divided into three stages in order to give time to users to switch to an alternative.</p>
<ol style="list-style-type: decimal">
<li><p><img src="figures/lifecycle-soft-deprecated.svg" alt="Soft deprecated" style="vertical-align:middle"> The author is no longer happy with a feature because they consider it sub-optimal compared to some other approach, or simply because they no longer have the time to maintain it. A soft-deprecated feature can still be used without hassle, but users should consider switching to an alternative approach.</p></li>
<li><p><img src="figures/lifecycle-deprecated.svg" alt="Deprecated" style="vertical-align:middle"> The feature is likely to be discontinued in the next major release. Users should switch to an alternative approach as soon as possible.</p></li>
<li><p><img src="figures/lifecycle-defunct.svg" alt="Defunct" style="vertical-align:middle"> The feature can no longer be used. A defunct function is still exported, and a defunct argument is still part of the signature. This way an informative error can be thrown.</p></li>
</ol>
<p>Finally, when a feature is no longer exposed or mentioned in the released version of the package, it is said to be <em>archived</em>.</p>
</div>
<div id="rd-badges" class="section level3">
<h3 class="hasAnchor">
<a href="#rd-badges" class="anchor"></a>Badges</h3>
<p>Make sure your users know what stage a feature is by adding badges in the help topics of your functions.</p>
<p><img src="figures/example-badge.png" align="center" alt="badge"></p>
<ul>
<li><p>Call <code>usethis::use_lifecycle()</code> to import the badges in your package.</p></li>
<li>
<p>Use the <code>lifecycle</code> Rd macro to insert a badge:</p>
<pre><code>#' \lifecycle{experimental}
#' \lifecycle{soft-deprecated}</code></pre>
<p>This badge renders as text in non-HTML documentation. To document the status of a whole function, a good place to include the badge is at the top of the <code>@description</code> block. To document an argument, you can put the badge in the argument description.</p>
</li>
<li><p>For functions in development, you typically don’t need to advertise the status if it is the same as the package as a whole. For instance, if your package is <a href="https://www.tidyverse.org/lifecycle/#maturing">maturing</a>, only signal functions in the experimental, stable, and questioning stages.</p></li>
</ul>
</div>
<div id="verbosity-of-deprecation" class="section level3">
<h3 class="hasAnchor">
<a href="#verbosity-of-deprecation" class="anchor"></a>Verbosity of deprecation</h3>
<p>lifecycle offers three levels of verbosity corresponding to the three deprecation stages.</p>
<ul>
<li>
<p><strong>Soft deprecation</strong>: At this stage, call <code><a href="../reference/deprecate_soft.html">deprecate_soft()</a></code> to start warning users about the deprecation in the least disruptive way.</p>
<p>This function only warns (a) users who try the feature from the global workspace, and (b) developers who directly use the feature, when they run unit tests with testthat. No warning is issued outside of unit tests, or when the deprecated feature is called from another package then ther own.</p>
<p>When a warning does get issued, users only see it once every 8 hours rather than at each invokation.</p>
</li>
<li><p><strong>Deprecation</strong>: At this stage, call <code><a href="../reference/deprecate_soft.html">deprecate_warn()</a></code> to warn unconditionally about the deprecated feature. The warning is issued only once every 8 hours.</p></li>
<li><p><strong>Defunct</strong>: The feature is discontinued. Call <code><a href="../reference/deprecate_soft.html">deprecate_stop()</a></code> to fail with an error.</p></li>
</ul>
</div>
<div id="deprecating-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecating-functions" class="anchor"></a>Deprecating functions</h3>
<p>These functions take the version number starting from which the feature is considered deprecated (it should remain the same across all deprecation stages), and a feature descriptor:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"mypkg::foo()"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Warning: `foo()` is deprecated as of mypkg 1.0.0.</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; This warning is displayed once every 8 hours.</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span></a></code></pre></div>
<p>You can optionally provide a replacement:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"mypkg::foo()"</span>, <span class="st">"new()"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Warning: `foo()` is deprecated as of mypkg 1.0.0.</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; Please use `new()` instead.</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; This warning is displayed once every 8 hours.</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span></a></code></pre></div>
<p>For the purpose of these examples we explicitly mentioned the namespace with <code>mypkg::</code>, however you can typically omit it because lifecycle infers the namespace from the calling environment. Specifying the namespace is mostly useful when the replacement is implemented in a different package.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># The new replacement</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">foobar_adder &lt;-<span class="st"> </span><span class="cf">function</span>(foo, bar) {</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  foo <span class="op">+</span><span class="st"> </span>bar</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># The old function still exported for compatibility</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">foobaz_adder &lt;-<span class="st"> </span><span class="cf">function</span>(foo, bar) {</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"foobaz_adder()"</span>, <span class="st">"foobar_adder()"</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="kw">foobar_adder</span>(foo, bar)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">}</a></code></pre></div>
</div>
<div id="deprecating-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecating-arguments" class="anchor"></a>Deprecating arguments</h3>
<p>The syntax for deprecating argument is based on the syntax for deprecating functions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"mypkg::foo(arg = )"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; Warning: The `arg` argument of `foo()` is deprecated as of mypkg 1.0.0.</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; This warning is displayed once every 8 hours.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"mypkg::foo(arg = )"</span>, <span class="st">"mypkg::foo(new = )"</span>)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Warning: The `arg` argument of `foo()` is deprecated as of mypkg 1.0.0.</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; Please use the `new` argument instead.</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; This warning is displayed once every 8 hours.</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span></a></code></pre></div>
<p>An argument can be partially deprecated by disallowing certain input types:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"mypkg::foo(arg = 'must be a scalar integer')"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; Warning: The `arg` argument of `foo()` must be a scalar integer as of mypkg 1.0.0.</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; This warning is displayed once every 8 hours.</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span></a></code></pre></div>
<p>lifecycle also provides the <code><a href="../reference/deprecated.html">deprecated()</a></code> sentinel to use as default argument. This provides self-documentation for your users and makes it possible for external tools to determine which arguments are deprecated. Test whether the argument was supplied by the caller with <code><a href="../reference/deprecated.html">lifecycle::is_present()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">foobar_adder &lt;-<span class="st"> </span><span class="cf">function</span>(foo, bar, <span class="dt">baz =</span> <span class="kw"><a href="../reference/deprecated.html">deprecated</a></span>()) {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="co"># Check if user has supplied `baz` instead of `bar`</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="cf">if</span> (lifecycle<span class="op">::</span><span class="kw"><a href="https://lifecycle.r-lib.org/reference/deprecated.html">is_present</a></span>(baz)) {</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="co"># Signal the deprecation to the user</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    <span class="kw"><a href="../reference/deprecate_soft.html">deprecate_warn</a></span>(<span class="st">"1.0.0"</span>, <span class="st">"foobar_adder(baz = )"</span>, <span class="st">"foobar_adder(bar = )"</span>)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">    <span class="co"># Deal with the deprecated argument for compatibility</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">    bar &lt;-<span class="st"> </span>baz</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">  }</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12">  foo <span class="op">+</span><span class="st"> </span>bar</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">}</a></code></pre></div>
</div>
<div id="workflow" class="section level3">
<h3 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h3>
<div id="where-do-these-deprecation-warnings-come-from" class="section level4">
<h4 class="hasAnchor">
<a href="#where-do-these-deprecation-warnings-come-from" class="anchor"></a>Where do these deprecation warnings come from?</h4>
<p>Call <code><a href="../reference/last_warnings.html">lifecycle::last_warnings()</a></code> to see backtraces for all the deprecation warnings that were issued during the last top-level command.</p>
</div>
<div id="bumping-deprecation-stage" class="section level4">
<h4 class="hasAnchor">
<a href="#bumping-deprecation-stage" class="anchor"></a>Bumping deprecation stage</h4>
<p>Some manual search and replace is needed to bump the status of deprecated features. We recommend starting with defunct features and work your way up:</p>
<ol style="list-style-type: decimal">
<li><p>Search for <code><a href="../reference/deprecate_soft.html">deprecate_stop()</a></code> and remove the feature from the package. The feature is now archived.</p></li>
<li><p>Search for <code><a href="../reference/deprecate_soft.html">deprecate_warn()</a></code> and replace with <code><a href="../reference/deprecate_soft.html">deprecate_stop()</a></code>.</p></li>
<li><p>Search for <code><a href="../reference/deprecate_soft.html">deprecate_soft()</a></code> and replace with <code><a href="../reference/deprecate_soft.html">deprecate_warn()</a></code>.</p></li>
<li><p>Call <code><a href="../reference/deprecate_soft.html">deprecate_soft()</a></code> from newly deprecated functions.</p></li>
</ol>
<p>Don’t forget to update the badges in the documentation topics.</p>
</div>
<div id="find-out-what-deprecated-features-you-rely-on" class="section level4">
<h4 class="hasAnchor">
<a href="#find-out-what-deprecated-features-you-rely-on" class="anchor"></a>Find out what deprecated features you rely on</h4>
<p>Test whether your package depends on deprecated features directly or indirectly by setting the verbosity option in the <code>tests/testthat.R</code> file just before <code><a href="https://rdrr.io/pkg/testthat/man/test_dir.html">test_check()</a></code> is called:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(testthat)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mypackage)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"error"</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/test_dir.html">test_check</a></span>(<span class="st">"mypackage"</span>)</a></code></pre></div>
<p>This forces all deprecated features to fail. You can also set the relevant options manually to force warnings or errors in your session:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Force silence</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"quiet"</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># Force warnings</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"warning"</span>)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co"># Force errors</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"error"</span>)</a></code></pre></div>
<p>Forcing warnings can be useful in conjuction with <code><a href="../reference/last_warnings.html">last_warnings()</a></code>, which prints backtraces for all the deprecation warnings issued during the last top-level command.</p>
</div>
<div id="test-deprecated-features" class="section level4">
<h4 class="hasAnchor">
<a href="#test-deprecated-features" class="anchor"></a>Test deprecated features</h4>
<p>Test whether a deprecated feature still works by setting <code>lifecycle_verbosity</code> to <code>"quiet"</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/test_that.html">test_that</a></span>(<span class="st">"`baz` argument of `foobar_adder()` still works"</span>, {</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  withr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/withr/man/with_options.html">local_options</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"quiet"</span>))</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="kw">foobar_adder</span>(<span class="dv">1</span>, <span class="dt">baz =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">})</a></code></pre></div>
<p>You can also set up verbosity for a whole testthat file within <code><a href="https://rdrr.io/pkg/testthat/man/teardown.html">setup()</a></code> and <code><a href="https://rdrr.io/pkg/testthat/man/teardown.html">teardown()</a></code> blocks:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/teardown.html">setup</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="st">"quiet"</span>))</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/teardown.html">teardown</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="dt">lifecycle_verbosity =</span> <span class="ot">NULL</span>))</a></code></pre></div>
<p>Test that a feature is correctly deprecated with <code><a href="../reference/expect_deprecated.html">expect_deprecated()</a></code> or <code><a href="../reference/expect_deprecated.html">expect_defunct()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/test_that.html">test_that</a></span>(<span class="st">"`baz` argument of `foobar_adder()` is deprecated"</span>, {</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  <span class="kw"><a href="../reference/expect_deprecated.html">expect_deprecated</a></span>(<span class="kw">foobar_adder</span>(<span class="dv">1</span>, <span class="dt">baz =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">})</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/pkg/testthat/man/test_that.html">test_that</a></span>(<span class="st">"`foo()` is defunct"</span>, {</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">  <span class="kw"><a href="../reference/expect_deprecated.html">expect_defunct</a></span>(<span class="kw">foo</span>())</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">})</a></code></pre></div>
<p>More control over verbosity can be exercised with the <code>lifecycle_verbosity</code> option. See <code><a href="../reference/verbosity.html">?verbosity</a></code>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lionel Henry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
