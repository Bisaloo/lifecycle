<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manage the Life Cycle of your Package Functions • lifecycle</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Manage the Life Cycle of your Package Functions">
<meta property="og:description" content="Manage the life cycle of your exported functions with
    shared conventions, documentation badges, and non-invasive
    deprecation warnings.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lifecycle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">

<p><a href="https://travis-ci.org/r-lib/lifecycle"><img src="https://travis-ci.org/r-lib/lifecycle.svg?branch=master" alt="Travis build status"></a> <a href="https://codecov.io/gh/r-lib/lifecycle?branch=master"><img src="https://codecov.io/gh/r-lib/lifecycle/branch/master/graph/badge.svg" alt="Codecov test coverage"></a> <!-- badges: end --></p>
<div id="lifecycle" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lifecycle" class="anchor"></a>lifecycle</h1></div>
<p>lifecycle provides a set of tools and conventions to manage the life cycle of your exported functions.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the development version of lifecycle from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"r-lib/lifecycle"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Use lifecycle to document the status of your exported functions and arguments:</p>
<ul>
<li><p>Choose one of the 7 lifecycle stages a function or argument can be in. You can choose from 4 development stages (experimental, maturing, stable, and questining) and 3 deprecation stages (soft-deprecated, deprecated, and defunct).</p></li>
<li><p>If the function or argument is deprecated, make sure your users know about by calling <code><a href="reference/deprecate_soft.html">deprecate_soft()</a></code>, <code><a href="reference/deprecate_soft.html">deprecate_warn()</a></code>, or <code><a href="reference/deprecate_soft.html">deprecate_stop()</a></code>. These functions try to be informative without being too verbose, with increasing levels of verbosity as the deprecation stage advances.</p></li>
<li><p>Include the relevant lifecycle badge in your documentation.</p></li>
</ul>
<div id="stages" class="section level3">
<h3 class="hasAnchor">
<a href="#stages" class="anchor"></a>Stages</h3>
<p>The lifecycle stages for functions and arguments closely mirror the <a href="https://www.tidyverse.org/lifecycle/">lifecycle stages for packages</a>.</p>
<p>There are 4 <strong>development</strong> stages.</p>
<ol>
<li><p><img src="reference/figures/lifecycle-experimental.svg" align="left" alt="Experimental"> This is a new feature that is in the very early stage of development. It is exported so users can start to use it and report feedback, but its interface and/or behaviour is likely to change in the future. It is generally best to avoid depending on experimental features.</p></li>
<li><p><img src="reference/figures/lifecycle-maturing.svg" align="left" alt="Maturing">. The interface and behaviour of a maturing feature has been roughed out, but finer details are likely to change. It still needs more feedback to find the optimal API.</p></li>
<li><p><img src="reference/figures/lifecycle-stable.svg" align="left" alt="Stable"> A feature is considered stable when the author is happy with its interface and behaviour. Major changes are unlikely, and breaking changes will occur gradually, through a deprecation process.</p></li>
<li><p><img src="reference/figures/lifecycle-questioning.svg" align="left" alt="Questioning"> The author is no longer convinced that the feature is the optimal approach. However, there are no recommended alternatives yet.</p></li>
</ol>
<p>Once the decision of discontinuing a feature has been made, it goes through 3 <strong>deprecation</strong> stages.</p>
<ol>
<li><p><img src="reference/figures/lifecycle-soft-deprecated.svg" align="left" alt="Soft deprecated">. The author is no longer happy with a feature because they consider it sub-optimal compared to some other approach, or simply because they no longer have the time to maintain it. A soft-deprecated feature can still be used without hassle, but users should consider switching to an alternative approach.</p></li>
<li><p><img src="reference/figures/lifecycle-deprecated.svg" align="left" alt="Deprecated">. The feature is likely to be discontinued in the next major release. Users should switch to an alternative approach as soon as possible.</p></li>
<li><p><img src="reference/figures/lifecycle-defunct.svg" align="left" alt="Defunct">. The feature can no longer be used. A defunct function is still exported, and a defunct argument is still part of the signature. This way an informative error can be thrown.</p></li>
</ol>
<p>Finally, when a feature is no longer exposed or mentioned in the released version of the package, it is said to be <strong>archived</strong>.</p>
</div>
<div id="badges" class="section level3">
<h3 class="hasAnchor">
<a href="#badges" class="anchor"></a>Badges</h3>
<p>Make sure your users know what stage a feature is by adding badges in the help topics of your functions.</p>
<p><img src="reference/figures/example-badge.png" align="center" alt="badge"></p>
<ul>
<li><p>Call <code>usethis::use_lifecycle()</code> to import the badges in your package.</p></li>
<li>
<p>Use the <code>lifecycle</code> Rd macro to insert a badge:</p>
<pre><code>#' \lifecycle{experimental}
#' \lifecycle{soft-deprecated}</code></pre>
<p>This badge renders as text in non-HTML documentation. To document the status of a whole function, a good place to include the badge is at the top of the <code>@description</code> block. To document an argument, you can put the badge in the argument description.</p>
</li>
<li><p>For functions in development, you typically don’t need to advertise the status if it is the same as the package as a whole. For instance, if your package is <a href="https://www.tidyverse.org/lifecycle/#maturing">maturing</a>, only signal functions in the experimental, stable, and questioning stages.</p></li>
</ul>
</div>
<div id="verbosity-of-deprecation" class="section level3">
<h3 class="hasAnchor">
<a href="#verbosity-of-deprecation" class="anchor"></a>Verbosity of deprecation</h3>
<p>lifecycle offers three levels of verbosity corresponding to the three deprecation stages.</p>
<ul>
<li>
<p><strong>Soft deprecation</strong>: At this stage, call <code><a href="reference/deprecate_soft.html">deprecate_soft()</a></code> to start warning users about the deprecation in the least disruptive way.</p>
<p>This function only warns (a) users who try the feature from the global workspace, and (b) developers who directly use the feature, when they run unit tests with testthat. No warning is issued outside of unit tests, or when the deprecated feature is called from another package then ther own.</p>
<p>When a warning does get issued, users only see it once per session rather than at each invokation.</p>
</li>
<li><p><strong>Deprecation</strong>: At this stage, call <code><a href="reference/deprecate_soft.html">deprecate_warn()</a></code> to warn unconditionally about the deprecated feature. The warning is issued only once per session.</p></li>
<li><p><strong>Defunct</strong>: The feature is discontinued. Call <code><a href="reference/deprecate_soft.html">deprecate_stop()</a></code> to fail with an error.</p></li>
</ul>
</div>
<div id="deprecating-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecating-functions" class="anchor"></a>Deprecating functions</h3>
<p>These functions take the version number starting from which the feature is considered deprecated (it should remain the same across all deprecation stages), and a feature descriptor:</p>
<pre><code><a href="reference/deprecate_soft.html">deprecate_warn("1.0.0", "mypkg::foo()")
#&gt; Warning message:
#&gt; `foo()` is deprecated as of mypkg 1.0.0.</a></code></pre>
<p>You can optionally provide a replacement:</p>
<pre><code><a href="reference/deprecate_soft.html">deprecate_warn("1.0.0", "mypkg::foo()", "new()")
#&gt; Warning message:
#&gt; `foo()` is deprecated as of mypkg 1.0.0.
#&gt; Please use `new()` instead.</a></code></pre>
<p>For the purpose of these examples we explicitly mentioned the namespace with <code>mypkg::</code>, however you can typically omit it because lifecycle infers the namespace from the calling environment. Specifying the namespace is mostly useful when the replacement is implemented in a different package.</p>
<pre class="{r}"><code># The new replacement
foobar_adder &lt;- function(foo, bar) {
  foo + bar
}

# The old function still exported for compatibility
foobaz_adder &lt;- function(foo, bar) {
  deprecate_warn("1.0.0", "foobaz_adder()", "foobar_adder()")
  foobar_adder(foo, bar)
}</code></pre>
</div>
<div id="deprecating-arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#deprecating-arguments" class="anchor"></a>Deprecating arguments</h3>
<p>The syntax for deprecating argument is based on the syntax for deprecating functions:</p>
<pre class="{r}"><code><a href="reference/deprecate_soft.html">deprecate_warn("1.0.0", "mypkg::foo(arg = )")
#&gt; Warning message:
#&gt; The `arg` argument of `foo()` is deprecated as of mypkg 1.0.0.

deprecate_warn("1.0.0", "mypkg::foo(arg = )", "mypkg::foo(new = )")
#&gt; Warning message:
#&gt; The `arg` argument of `foo()` is deprecated as of mypkg 1.0.0.
#&gt; Please use the `new` argument instead.</a></code></pre>
<p>lifecycle also provides the <code><a href="reference/deprecated.html">deprecated()</a></code> sentinel to use as default argument. This provides self-documentation for your users, and makes it possible for external tools to determine which arguments are deprecated. This sentinel is simply the missing argument, so you can test whether the argument was supplied with <code><a href="https://rlang.r-lib.org/reference/missing_arg.html">rlang::is_missing()</a></code>:</p>
<pre class="{r}"><code>foobar_adder &lt;- function(foo, bar, baz = deprecated()) {
  # Check if user has supplied `baz` instead of `bar`
  if (!rlang::is_missing(baz)) {

    # Signal the deprecation to the user
    deprecate_warn("1.0.0", "foobar_adder(baz = )", "foobar_adder(bar = )")

    # Deal with the deprecated argument for compatibility
    bar &lt;- baz
  }

  foo + bar
}</code></pre>
</div>
<div id="workflow" class="section level3">
<h3 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h3>
<div id="where-do-these-deprecation-warnings-come-from" class="section level4">
<h4 class="hasAnchor">
<a href="#where-do-these-deprecation-warnings-come-from" class="anchor"></a>Where do these deprecation warnings come from?</h4>
<p>Call <code><a href="reference/last_warnings.html">lifecycle::last_warnings()</a></code> to see backtraces for all the deprecation warnings that were issued during the last top-level command.</p>
</div>
<div id="bumping-deprecation-stage" class="section level4">
<h4 class="hasAnchor">
<a href="#bumping-deprecation-stage" class="anchor"></a>Bumping deprecation stage</h4>
<p>Some manual search and replace is needed to bump the status of deprecated features. We recommend starting with defunct features and work your way up:</p>
<ol>
<li><p>Search for <code><a href="reference/deprecate_soft.html">deprecate_stop()</a></code> and remove the feature from the package. The feature is now archived.</p></li>
<li><p>Search for <code><a href="reference/deprecate_soft.html">deprecate_warn()</a></code> and replace with <code><a href="reference/deprecate_soft.html">deprecate_stop()</a></code>.</p></li>
<li><p>Search for <code><a href="reference/deprecate_soft.html">deprecate_soft()</a></code> and replace with <code><a href="reference/deprecate_soft.html">deprecate_warn()</a></code>.</p></li>
<li><p>Call <code><a href="reference/deprecate_soft.html">deprecate_soft()</a></code> from newly deprecated functions.</p></li>
</ol>
<p>Don’t forget to update the badges in the documentation topics.</p>
</div>
</div>
<div id="test-deprecated-features" class="section level3">
<h3 class="hasAnchor">
<a href="#test-deprecated-features" class="anchor"></a>Test deprecated features</h3>
<p>You can test that a deprecated feature still works by disabling the warnings with <code><a href="reference/scoped_lifecycle_silence.html">scoped_lifecycle_silence()</a></code>:</p>
<pre class="{r}"><code><a href="https://www.rdocumentation.org/packages/testthat/topics/test_that">test_that("`baz` argument of `foobar_adder()` still works", {
  scoped_lifecycle_silence()
  foobar_adder(1, baz = 2)
})</a></code></pre>
<p>You can test that a feature is correctly deprecated by forcing warnings and checking the class <code>"lifecycle_warning_deprecated"</code>:</p>
<pre class="{r}"><code><a href="https://www.rdocumentation.org/packages/testthat/topics/test_that">test_that("`baz` argument of `foobar_adder()` is deprecated", {
  scoped_lifecycle_warnings()
  expect_warning(foobar_adder(1, baz = 2), class = "lifecycle_warning_deprecated")
})</a></code></pre>
<p>Defunct features throw errors of class <code>"lifecycle_error_deprecated"</code>:</p>
<pre class="{r}"><code><a href="https://www.rdocumentation.org/packages/testthat/topics/test_that">test_that("`foo()` is defunct", {
  expect_error(foo(), class = "lifecycle_error_deprecated")
})</a></code></pre>
</div>
<div id="find-out-what-deprecated-features-you-rely-on" class="section level3">
<h3 class="hasAnchor">
<a href="#find-out-what-deprecated-features-you-rely-on" class="anchor"></a>Find out what deprecated features you rely on</h3>
<p>Test whether your package depends on deprecated features directly or indirectly by inserting <code><a href="reference/scoped_lifecycle_silence.html">scoped_lifecycle_errors()</a></code> in the <code>tests/testthat.R</code> file just before <code><a href="https://www.rdocumentation.org/packages/testthat/topics/test_dir">test_check()</a></code> is called:</p>
<pre class="{r}"><code><a href="https://www.rdocumentation.org/packages/base/topics/library">library(testthat)
library(mypackage)

scoped_lifecycle_errors()
test_check("mypackage")</a></code></pre>
<p>This forces all deprecated features to fail. You can also set the relevant options manually to force warnings or errors in your session:</p>
<pre class="{r}"><code><a href="https://www.rdocumentation.org/packages/base/topics/options"># Force warnings
options(
  lifecycle_quiet_warnings = FALSE,
  lifecycle_force_warnings = TRUE
)

# Force errors
options(
  lifecycle_quiet_warnings = FALSE,
  lifecycle_force_warnings = TRUE,
  lifecycle_force_errors = TRUE
)</a></code></pre>
<p>Forcing warnings can be useful in conjuction with <code><a href="reference/last_warnings.html">last_warnings()</a></code>, which prints backtraces for all the deprecation warnings issued during the last top-level command.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Lionel Henry <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>

      <footer><div class="copyright">
  <p>Developed by Lionel Henry.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
